"use strict";
var cmark = require("cmark");

exports.parseAST = function(markdown) {
  var reader = new cmark.DocParser();
  return reader.parse(markdown);
};

"use strict";
var shapes = {
  document: "note",
  block: "box",
  inline: "oval",
};


var solarizedLight = {
  back: "#fdf6e3",
  fill: "#eee8d5",
  font: "#073642",
  strg: "#586e75",
  edge: "#002b36",
  code: "#268bd2",
};

var solarizedDark = {
  back: "#002b36",
  fill: "#073642",
  font: "#fdf6e3",
  strg: "#eee8d5",
  edge: "#93a1a1",
  code: "#2aa198",
};

exports.palettes = { solarizedLight: solarizedLight, solarizedDark: solarizedDark };


var defaults = {
  palette: solarizedLight,
  fontsize: 14,
  fontname: "Inconsolata",
};


exports.exportDot = function(ast, filename, options) {
  if (options === undefined)
    options = {};

  var _pal  = options.palette  || defaults.palette;
  var _size = options.fontsize || defaults.fontsize;
  var _font = options.fontname || defaults.fontname;

  var out = ["digraph \"" + filename + "\" {",
             "graph [rankdir=\"LR\", bgcolor=\"" + _pal.back + "\"];",
             "node [style=\"filled\", fontcolor=\"" + _pal.font + "\", fillcolor=\"" + _pal.fill + "\", color=\"" + _pal.edge + "\", fontsize=" + _size + ", fontname=\"" + _font + "\"];",
             "edge [color=\"" + _pal.edge + "\"];"
            ];
  var n = 0;

  var builder = function(_pal) {
    return function(items, type) {
      var ids = [];

      for (var _iterator = items[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {
        var _item = _step.value;
        var _id = n++;
        var _children = [];
        if (_item.children) {
          _children = _children.concat(builder(_item.children, "block"));
        }
        if (_item.inline_content) {
          _children = _children.concat(builder(_item.inline_content, "inline"));
        }
        if (Array.isArray(_item.c)) {
          _children = _children.concat(builder(_item.c, "inline"));
        }
        if (Array.isArray(_item.label)) {
          _children = _children.concat(builder(_item.label, "inline"));
        }
        var _shape = shapes[type];
        var _label = _item.t;
        if (_item.t === "Str" || _item.t === "Code") {
          _label = "'" + _item.c + "'";
        }
        var _more = "";
        if (_item.t === "Str") {
          _more = ", fontcolor=\"" + _pal.strg + "\"";
        } else if (_item.t === "Code") {
          _more = ", fontcolor=\"" + _pal.code + "\"";
        } else if (_item.t === "Link") {
          _more = ", href=\"" + _item.destination + "\"";
        }
        out.push("  n" + _id + " [label=\"" + _label + "\", shape=\"" + _shape + "\"" + _more + "];");

        for (var _child, t$3$0 = regeneratorRuntime.values(_children), t$3$1; !(t$3$1 = t$3$0.next()).done; ) {
          _child = t$3$1.value;
          out.push("  n" + _id + " -> n" + _child + ";");
        }

        ids.push(_id);
      }

      return ids;
    };
  }(_pal);

  builder([ast], "document");
  out.push('}');
  return out.join("\n");
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL25vbm8vZGV2L21kZGlmZi9zcmMvYXN0LmpzIiwiL2hvbWUvbm9uby9kZXYvbWRkaWZmL3NyYy9kb3QuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7O0FBRTVCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtFQUNwQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNsQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQy9CLENBQUM7OztBQ0xELENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7RUFDWCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNoQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDWixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2hCLENBQUM7OztBQUdELENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0VBQ25CLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNmLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNmLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNmLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNmLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNmLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNqQixDQUFDOztBQUVELENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtFQUNsQixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDZixDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakIsQ0FBQzs7QUFFRCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsZ0NBQWdCLCtCQUFnQixDQUFDOzs7QUFHcEQsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7RUFDYixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztFQUNaLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDekIsQ0FBQzs7O0FBR0QsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQU4sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFBTixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFFLENBQUM7O1lBQzFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN0QyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7O0VBRS9DLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsZ0JBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFPO3VEQUNTLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBTTswREFDUCxDQUFDLENBQUMsQ0FBQyxDQUFDLDZCQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDLHlCQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDLDhEQUFpRDtvQ0FDekgsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QixDQUFDO0VBQ1gsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7O0VBRVQsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtXQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7TUFDaEMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7OzJCQUNLLENBQUMsQ0FBQyxDQUFDLENBQUM7O2dCQUNaLEVBQUUsQ0FBQyxDQUFDO3NCQUNFLEVBQUUsQ0FBQztRQUNoQixDQUFDLEVBQUUsTUFBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFO29CQUNSLFdBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdEO1FBQ0EsQ0FBQyxFQUFFLE1BQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtvQkFDZCxXQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3BFO1FBQ0EsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ2hCLFdBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZEO1FBQ0EsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtvQkFDcEIsV0FBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMzRDttQkFDVSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzttQkFDYixPQUFNLENBQUM7UUFDakIsQ0FBQyxFQUFFLE1BQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7aUJBQ25DLGFBQVcsQ0FBQyxPQUFLO1FBQ3pCO2tCQUNTLEVBQUUsQ0FBQztRQUNaLENBQUMsRUFBRSxNQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDZix5QkFBc0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFLO1FBQ3RDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsTUFBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDdkIseUJBQXNCLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBSztRQUN0QyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE1BQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ3ZCLHFCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBSztRQUN6QztRQUNBLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvRkFBZ0UsQ0FBQzs7OztVQUV2RSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMscUNBQTZCLENBQUM7OztRQUV4QyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBRyxDQUFDOzs7TUFFZCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQzs7U0FDWDs7RUFFRCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQzFCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDYixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Q0FDdEIiLCJmaWxlIjoibWRkaWZmLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNtYXJrID0gcmVxdWlyZShcImNtYXJrXCIpO1xuXG5leHBvcnRzLnBhcnNlQVNUID0gZnVuY3Rpb24obWFya2Rvd24pIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBjbWFyay5Eb2NQYXJzZXIoKTtcbiAgcmV0dXJuIHJlYWRlci5wYXJzZShtYXJrZG93bik7XG59O1xuIiwidmFyIHNoYXBlcyA9IHtcbiAgZG9jdW1lbnQ6IFwibm90ZVwiLFxuICBibG9jazogXCJib3hcIixcbiAgaW5saW5lOiBcIm92YWxcIixcbn07XG5cblxudmFyIHNvbGFyaXplZExpZ2h0ID0ge1xuICBiYWNrOiBcIiNmZGY2ZTNcIixcbiAgZmlsbDogXCIjZWVlOGQ1XCIsXG4gIGZvbnQ6IFwiIzA3MzY0MlwiLFxuICBzdHJnOiBcIiM1ODZlNzVcIixcbiAgZWRnZTogXCIjMDAyYjM2XCIsXG4gIGNvZGU6IFwiIzI2OGJkMlwiLFxufTtcblxudmFyIHNvbGFyaXplZERhcmsgPSB7XG4gIGJhY2s6IFwiIzAwMmIzNlwiLFxuICBmaWxsOiBcIiMwNzM2NDJcIixcbiAgZm9udDogXCIjZmRmNmUzXCIsXG4gIHN0cmc6IFwiI2VlZThkNVwiLFxuICBlZGdlOiBcIiM5M2ExYTFcIixcbiAgY29kZTogXCIjMmFhMTk4XCIsXG59O1xuXG5leHBvcnRzLnBhbGV0dGVzID0geyBzb2xhcml6ZWRMaWdodCwgc29sYXJpemVkRGFyayB9O1xuXG5cbnZhciBkZWZhdWx0cyA9IHtcbiAgcGFsZXR0ZTogc29sYXJpemVkTGlnaHQsXG4gIGZvbnRzaXplOiAxNCxcbiAgZm9udG5hbWU6IFwiSW5jb25zb2xhdGFcIixcbn07XG5cblxuZXhwb3J0cy5leHBvcnREb3QgPSBmdW5jdGlvbihhc3QsIGZpbGVuYW1lLCBvcHRpb25zPXt9KSB7XG4gIGxldCBwYWwgID0gb3B0aW9ucy5wYWxldHRlICB8fCBkZWZhdWx0cy5wYWxldHRlO1xuICBsZXQgc2l6ZSA9IG9wdGlvbnMuZm9udHNpemUgfHwgZGVmYXVsdHMuZm9udHNpemU7XG4gIGxldCBmb250ID0gb3B0aW9ucy5mb250bmFtZSB8fCBkZWZhdWx0cy5mb250bmFtZTtcblxuICB2YXIgb3V0ID0gW2BkaWdyYXBoIFwiJHsgZmlsZW5hbWUgfVwiIHtgLFxuICAgICAgICAgICAgIGBncmFwaCBbcmFua2Rpcj1cIkxSXCIsIGJnY29sb3I9XCIke3BhbC5iYWNrfVwiXTtgLFxuICAgICAgICAgICAgIGBub2RlIFtzdHlsZT1cImZpbGxlZFwiLCBmb250Y29sb3I9XCIke3BhbC5mb250fVwiLCBmaWxsY29sb3I9XCIkeyBwYWwuZmlsbCB9XCIsIGNvbG9yPVwiJHsgcGFsLmVkZ2UgfVwiLCBmb250c2l6ZT0keyBzaXplIH0sIGZvbnRuYW1lPVwiJHsgZm9udCB9XCJdO2AsXG4gICAgICAgICAgICAgYGVkZ2UgW2NvbG9yPVwiJHsgcGFsLmVkZ2UgfVwiXTtgXG4gICAgICAgICAgICBdO1xuICB2YXIgbiA9IDA7XG5cbiAgdmFyIGJ1aWxkZXIgPSBmdW5jdGlvbihpdGVtcywgdHlwZSkge1xuICAgIHZhciBpZHMgPSBbXTtcbiAgICBmb3IgKGxldCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICBsZXQgaWQgPSBuKys7XG4gICAgICBsZXQgY2hpbGRyZW4gPSBbXTtcbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuKSB7XG4gICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uY29uY2F0KGJ1aWxkZXIoaXRlbS5jaGlsZHJlbiwgXCJibG9ja1wiKSk7XG4gICAgICB9XG4gICAgICBpZiAoaXRlbS5pbmxpbmVfY29udGVudCkge1xuICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmNvbmNhdChidWlsZGVyKGl0ZW0uaW5saW5lX2NvbnRlbnQsIFwiaW5saW5lXCIpKTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZW0uYykpIHtcbiAgICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbi5jb25jYXQoYnVpbGRlcihpdGVtLmMsIFwiaW5saW5lXCIpKTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZW0ubGFiZWwpKSB7XG4gICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uY29uY2F0KGJ1aWxkZXIoaXRlbS5sYWJlbCwgXCJpbmxpbmVcIikpO1xuICAgICAgfVxuICAgICAgbGV0IHNoYXBlID0gc2hhcGVzW3R5cGVdO1xuICAgICAgbGV0IGxhYmVsID0gaXRlbS50O1xuICAgICAgaWYgKGl0ZW0udCA9PT0gXCJTdHJcIiB8fCBpdGVtLnQgPT09IFwiQ29kZVwiKSB7XG4gICAgICAgIGxhYmVsID0gYCckeyBpdGVtLmMgfSdgO1xuICAgICAgfVxuICAgICAgbGV0IG1vcmUgPSBcIlwiO1xuICAgICAgaWYgKGl0ZW0udCA9PT0gXCJTdHJcIikge1xuICAgICAgICBtb3JlID0gYCwgZm9udGNvbG9yPVwiJHsgcGFsLnN0cmcgfVwiYDtcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS50ID09PSBcIkNvZGVcIikge1xuICAgICAgICBtb3JlID0gYCwgZm9udGNvbG9yPVwiJHsgcGFsLmNvZGUgfVwiYDtcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS50ID09PSBcIkxpbmtcIikge1xuICAgICAgICBtb3JlID0gYCwgaHJlZj1cIiR7IGl0ZW0uZGVzdGluYXRpb24gfVwiYDtcbiAgICAgIH1cbiAgICAgIG91dC5wdXNoKGAgIG4keyBpZCB9IFtsYWJlbD1cIiR7IGxhYmVsIH1cIiwgc2hhcGU9XCIkeyBzaGFwZSB9XCIkeyBtb3JlIH1dO2ApO1xuICAgICAgZm9yIChsZXQgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgb3V0LnB1c2goYCAgbiR7IGlkIH0gLT4gbiR7IGNoaWxkIH07YCk7XG4gICAgICB9XG4gICAgICBpZHMucHVzaChpZCk7XG4gICAgfVxuICAgIHJldHVybiBpZHM7XG4gIH07XG5cbiAgYnVpbGRlcihbYXN0XSwgXCJkb2N1bWVudFwiKTtcbiAgb3V0LnB1c2goJ30nKTtcbiAgcmV0dXJuIG91dC5qb2luKFwiXFxuXCIpO1xufTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==